(()=>{"use strict";function e(e,t){for(let n in t)e.setAttribute(n,t[n])}function t(e,t){const n=document.createElement(e);return n.classList.add(...t.split(" ")),n}const n=["Clear Oil","Sepia Oil","Amber Oil","Verdant Oil","Teal Oil","Azure Oil","Indigo Oil","Violet Oil","Crimson Oil","Black Oil","Opalescent Oil","Silver Oil","Golden Oil"],i="function"==typeof BigInt?BigInt:Number,r=e=>e<=Number.MAX_SAFE_INTEGER?Number(e):i(e);function l(e,t){if(e<0)throw new RangeError("negative n is not acceptable");if(t<0)throw new RangeError("negative k is not acceptable");if(0==t)return 1;if(e<t)return 0;[e,t]=[i(e),i(t)];let n=i(1);for(;t--;)n*=e--;return r(n)}function s(e){return l(e,e)}const o="undefined"!=typeof crypto?crypto:{},a="function"==typeof o.randomBytes?e=>Uint8Array.from(o.randomBytes(e)):"function"==typeof o.getRandomValues?e=>o.getRandomValues(new Uint8Array(e)):e=>Uint8Array.from(Array(e),(()=>256*Math.random()));class c{static of(...e){return new(Function.prototype.bind.apply(this,[null].concat(e)))}static from(e){return new(Function.prototype.bind.apply(this,[null].concat(e)))}[Symbol.iterator](){return function*(e,t){for(let n=0;n<t;n++)yield e.nth(n)}(this,this.length)}toArray(){return[...this]}get isBig(){return Number.MAX_SAFE_INTEGER<this.length}get isSafe(){return"undefined"!=typeof BigInt||!this.isBig}_check(e){if(e<0){if(this.length<-e)return;return r(i(this.length)+i(e))}if(!(this.length<=e))return e}nth(e){return[]}sample(){return this.nth(function(e=0,t=Math.pow(2,53)){let n=e.constructor;if(0===arguments.length)return Math.floor(Math.random()*n(t));if(1==arguments.length&&([e,t]=[n(0),e]),"number"==typeof e)return[e,t]=[Math.ceil(Number(e)),Math.ceil(Number(t))],Math.floor(Math.random()*(t-e))+e;const i=n(t)-n(e),r=i.toString(16).length,l=a(r).reduce(((e,t)=>(e<<n(8))+n(t)),n(0));return(n(l)*i>>n(8*r))+n(e)}(this.length))}samples(){return function*(e){for(;;)yield e.sample()}(this)}}class d extends c{constructor(e,t=0){super(),this.seed=[...e],this.size=0<t?t:this.seed.length,this.length=l(this.seed.length,this.size),Object.freeze(this)}nth(e){if(void 0===(e=this._check(e)))return;const t=this.seed.length-this.size,n=s(t);let r=function(e,t=0){if(e<0)return;let[n,r]=[i(e),i(1)];if(t)r=i(s(t));else{for(t=1;r<n;r*=i(++t));n<r&&(r/=i(t--))}let l=[0];for(;t;r/=i(t--))l[t]=Math.floor(Number(n/r)),n%=r;return l}(i(e)*i(n),this.seed.length),l=this.seed.slice(),o=[];for(let e=this.seed.length-1;t<=e;e--)o.push(l.splice(r[e],1)[0]);return o}}let u,h,m;fetch("./data/anointmentsAmulets.json").then((e=>e.json())).then((e=>u=JSON.parse(e))),fetch("./data/anointmentsRings.json").then((e=>e.json())).then((e=>h=JSON.parse(e))),fetch("./data/anointmentsMaps.json").then((e=>e.json())).then((e=>m=JSON.parse(e)));const p=(()=>{const e=n.map((e=>e.split(" ")[0].toLowerCase())).join(" ");return t=>{document.querySelectorAll("table tbody tr.hide").forEach((e=>e.classList.remove("hide")));const n=new RegExp(`(?<=^| )(${t.toLowerCase()}[a-z]*)`,"g"),i=`table tbody tr:not(.${e.match(n)?.join(", .")})`;t&&document.querySelectorAll(i).forEach((e=>e.classList.add("hide")))}})();function f({target:n}){const i=new Map;let r=0;if(Array.from(document.getElementsByClassName("oil-input-wrap")).forEach((({children:[{innerText:e},{value:t}]})=>{if(+t){const n=Math.abs(t)>=3?3:+t;i.set(e.split(" ")[0],n),r+=n}})),document.getElementsByClassName("expand-section-wrap")[0]?.remove(),!function(e){const t=document.getElementsByClassName("error-wrap")[0],n=[...document.querySelectorAll(".checkbox")].filter((({checked:e})=>e))[0].id.match(/[0-9]/)[0];return e<n?(t.innerText=`Enter at least ${n} oil${n>1?"s":""}!`,t.classList.remove("hide"),!1):(t.classList.add("hide"),!0)}(r))return;n.disabled=!0,(()=>{const n=t("div","section expand-section-wrap"),i=t("input","filter-bar");e(i,{type:"text",autocomplete:"off",placeholder:"Filter by oil..."}),i.addEventListener("input",(e=>{p(e.target.value)})),n.append(i),document.getElementById("main").append(n)})();const l=[];i.forEach(((e,t)=>{for(let n=e;n>0;n--)l.push(t)}));const s={perm3Check:["Amulets and Blight uniques anointments",{className:"amulet-unique-table",unpackedJSON:u,permutation:null}],perm2Check:["Rings anointments",{className:"rings-table",unpackedJSON:h,permutation:null}],perm1Check:["Maps anointments",{className:"Maps-table",unpackedJSON:m,permutation:null}]};document.querySelectorAll(".checkbox").forEach((({checked:e,id:i})=>{if(e){const e=i.match(/[0-9]/)[0];new Promise((t=>setTimeout((()=>t(new Set([...new d(l,e)].map((e=>e.join("")))))),0))).then((e=>{s[i][1].permutation=e,function(e,n){const i=t("a","toggle");i.innerText=e;const r=t("span","arrow");r.innerText="▼";const l=t("span","arrow hide");l.innerText="▲",i.append(r,l),i.addEventListener("click",(function({target:e}){const{children:[t,n]}=e;t.classList.toggle("hide"),n.classList.toggle("hide"),e.nextElementSibling.classList.toggle("hide")}));const s=t("div","toggle-content hide");s.append(function({className:e,permutation:n,unpackedJSON:i}){const r=t("table","anoint-table"),l=r.createTHead().insertRow();for(let e=1;e<4;e++)l.insertCell().innerText=`Oil #${e}`;"amulet-unique-table"===e&&(l.insertCell().innerText="Skill name"),l.insertCell().innerText="Description";const s=r.createTBody();return n.forEach((e=>{if(Object.prototype.hasOwnProperty.call(i,e)){const{oil1:t,oil2:n,oil3:l,name:o="",description:a}=i[e],c=s.insertRow();r.rows.length%2==0&&c.classList.add("table-row-even"),[t,n,l].forEach((e=>{const t=e.split(" ")[0].toLowerCase();t&&c.classList.add(t)})),c.insertCell().innerText=t,c.lastElementChild.classList.add("table-cell-oil"),c.insertCell().innerText=n,c.lastElementChild.classList.add("table-cell-oil"),c.insertCell().innerText=l,c.lastElementChild.classList.add("table-cell-oil"),o&&(c.insertCell().innerText=o,c.lastElementChild.classList.add("table-cell-name")),c.insertCell().innerText=a,c.lastElementChild.classList.add("table-cell-description")}})),r}(n)),document.getElementsByClassName("expand-section-wrap")[0].append(i,s)}(...s[i])})).then((()=>n.disabled=!1))}}))}!function(){const i=document.createElement("main");i.setAttribute("id","main"),i.append(function(){const i=t("div","section oil-input-container"),r=t("div","oil-input-wrap"),l=t("p","oil-name"),s=t("input","oil-number-input");return e(s,{type:"number",min:0,placeholder:"0"}),r.append(l,s),n.forEach((e=>{const t=r.cloneNode(!0);t.firstElementChild.innerText=e,i.append(t)})),i}(),function(){const n=(()=>{const n=t("input","checkbox");e(n,{type:"checkbox",checked:!1});const i=document.createElement("label"),r=t("div","checkbox-group");return r.append(n,i),function({id:e,checked:t,innerText:n}){const i=r.cloneNode(!0);return i.firstElementChild.setAttribute("id",e),i.firstElementChild.checked=t,i.lastElementChild.innerText=n,i}})(),i=t("div","section checkbox-wrap");return i.append(n({id:"perm3Check",checked:!0,innerText:"Show Amulets and Blight uniques anointments"})),i.append(n({id:"perm2Check",checked:!1,innerText:"Show Ring anointments"})),i.append(n({id:"perm1Check",checked:!1,innerText:"Show Maps anointments"})),i.addEventListener("click",(function(e){e.target.matches(".checkbox")&&(document.getElementById("btn-calculate").disabled=![...document.querySelectorAll(".checkbox")].reduce(((e,{checked:t})=>e+t),0))})),i}(),function(){const e=document.createElement("button");return e.setAttribute("id","btn-calculate"),e.innerText="Calculate",e.addEventListener("click",f,!1),e}(),t("div","section error-wrap"),function(){const e=t("button","hide");return e.setAttribute("id","btn-scroll-up"),e.innerText="▲",document.addEventListener("scroll",(()=>window.scrollY>500?e.classList.remove("hide"):e.classList.add("hide"))),e.addEventListener("click",(()=>document.body.scrollIntoView({behavior:"smooth"}))),e}()),document.body.append(i)}()})();